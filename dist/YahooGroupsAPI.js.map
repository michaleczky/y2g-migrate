{"version":3,"sources":["../src/YahooGroupsAPI.js"],"names":["MESSAGE_ENDPOINT","groupName","msgNumber","MEMBERS_ENDPOINT","YahooGroupsAPI","options","cookie_T","hasOwnProperty","cookie_Y","headers","Cookie","url","axios","get","resp","Message","data","_isResponseValid","Error","MembersList","response","toLowerCase","startsWith","ygMessage","ygData","Symbol","iterator","index","members","next","value","Member","done","date","userId","email","postDate","authorName","from","subject","rawEmail"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\n\r\nconst MESSAGE_ENDPOINT = (groupName, msgNumber) => `https://groups.yahoo.com/api/v1/groups/${groupName}/messages/${msgNumber}/raw`;\r\nconst MEMBERS_ENDPOINT = (groupName) => `https://groups.yahoo.com/api/v1/groups/${groupName}/members/confirmed`;\r\n\r\nexport default class YahooGroupsAPI {\r\n\r\n    constructor(groupName, options = {}) {\r\n        this.groupName = groupName;\r\n        let cookie_T = options.hasOwnProperty('cookie_T') ? options.cookie_T : '';\r\n        let cookie_Y = options.hasOwnProperty('cookie_Y') ? options.cookie_Y : '';\r\n        let headers = {};\r\n        if (cookie_Y && cookie_T) {\r\n            headers.Cookie = `Y=${cookie_Y}; T=${cookie_T};`;\r\n        }\r\n        this.headers = headers;\r\n    }\r\n\r\n    async getMessageAsync(msgNumber) {\r\n        const url = MESSAGE_ENDPOINT(this.groupName, msgNumber);\r\n        const resp = await axios.get(url, { headers: this.headers });\r\n        return new Message(resp.data);\r\n    }\r\n\r\n    async getMembersListAsync() {\r\n        const url = MEMBERS_ENDPOINT(this.groupName);\r\n        const resp = await axios.get(url, { headers: this.headers});\r\n        if (!this._isResponseValid(resp)) {\r\n            throw new Error('Invalid response (non-JSON), possible authentication error.');\r\n        }\r\n        return new MembersList(resp.data);\r\n    }\r\n\r\n    _isResponseValid(response) {\r\n        return response.headers['content-type'].toLowerCase().startsWith('application/json');\r\n    }\r\n\r\n}\r\n\r\nclass MembersList {\r\n    constructor (ygMessage) {\r\n        this.ygMessage = ygMessage;\r\n        if (!this.ygMessage.hasOwnProperty('ygData')) {\r\n            this.ygMessage.ygData = {};\r\n        }\r\n    }\r\n\r\n    [Symbol.iterator]() {\r\n        let index = -1;\r\n        let data = this.ygMessage.ygData.members || [];\r\n        return {\r\n            next: () => ({value: new Member(data[++index]), done: !(index in data)})\r\n        };\r\n    }\r\n}\r\n\r\nclass Member {\r\n    constructor (data) {\r\n        this.data = data;\r\n    }\r\n\r\n    get getDate() {\r\n        return this.data.date;\r\n    }\r\n\r\n    get userId() {\r\n        return this.data.userId;\r\n    }\r\n\r\n    get email() {\r\n        return this.data.email;\r\n    }\r\n}\r\n\r\nclass Message {\r\n    constructor (ygMessage) {\r\n        this.ygMessage = ygMessage;\r\n    }\r\n\r\n    get postDate() {\r\n        return this.ygMessage.ygData.postDate;\r\n    }\r\n\r\n    get authorName() {\r\n        return this.ygMessage.ygData.authorName;\r\n    }\r\n\r\n    get from() {\r\n        return this.ygMessage.ygData.from;\r\n    }\r\n\r\n    get subject() {\r\n        return this.ygMessage.ygData.subject;\r\n    }\r\n\r\n    get rawEmail() {\r\n        return this.ygMessage.ygData.rawEmail;\r\n    }\r\n}"],"file":"YahooGroupsAPI.js"}